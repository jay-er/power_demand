# ⚡ 전력 수요 예측 시스템

전력 수요 예측을 위한 머신러닝 기반 웹 애플리케이션입니다.

## 🚀 주요 기능

### 📁 데이터 관리
- **엑셀 파일 업로드**: 직접 엑셀 파일을 업로드하여 사용
- **데이터 편집**: UI에서 직접 데이터를 보고 수정
- **데이터 다운로드**: 편집된 데이터를 CSV로 다운로드
- **데이터 검증**: 필수 컬럼 확인 및 오류 메시지

### 📊 데이터 처리
- Excel 파일에서 전력 수요 데이터 로딩
- 날짜 기반 데이터 전처리
- 특징 공학 (월, 요일, 평일 더미 변수 생성)
- 시계열 특성 반영 (어제의 수요량)

### 🤖 머신러닝 모델
- **최대수요 예측 모델**: 최고기온, 평균기온, 월, 어제의 최대수요 기반
- **최저수요 예측 모델**: 최저기온, 월, 어제의 최저수요 기반
- 랜덤 포레스트 회귀 알고리즘 사용

### 📈 성능 평가
- 평균 절대 오차 (MAE)
- 결정 계수 (R²)
- 예측값 vs 실제값 시각화
- 시간별 예측 결과 그래프

### 🎛️ 인터랙티브 기능
- 사이드바에서 모델 파라미터 조정
- 실시간 성능 평가
- 인터랙티브 차트 및 그래프
- 데이터 편집 및 미리보기

## 📋 설치 및 실행

### 1. 라이브러리 설치
```bash
pip install -r requirements.txt
```

### 2. 데이터 파일 준비
- **옵션 1**: `power_data.xlsx` 파일을 프로젝트 루트에 위치 (기본 파일)
- **옵션 2**: 앱에서 직접 엑셀 파일 업로드
- 파일에는 다음 컬럼이 포함되어야 함:
  - 날짜
  - 최고기온, 평균기온, 최저기온
  - 최대수요, 최저수요
  - 요일, 평일

### 3. Streamlit 앱 실행
```bash
streamlit run main.py
```

## 🎯 사용법

### 📁 데이터 업로드 및 편집
1. **파일 업로드**: "전력 수요 데이터 엑셀 파일 업로드" 버튼을 클릭하여 엑셀 파일 업로드
2. **기본 파일 사용**: 체크박스를 통해 기본 `power_data.xlsx` 파일 사용
3. **데이터 편집**: 
   - "📊 데이터 미리보기" 탭에서 전체 데이터 확인
   - "✏️ 데이터 편집" 탭에서 직접 데이터 수정
   - "📈 통계 정보" 탭에서 데이터 통계 확인
4. **변경사항 적용**: 편집 후 "변경사항 적용" 버튼 클릭
5. **데이터 다운로드**: 편집된 데이터를 CSV로 다운로드

### 🤖 모델 학습 및 평가
1. **모델 설정**: 사이드바에서 다음 파라미터를 조정할 수 있습니다:
   - 테스트 데이터 비율 (0.1~0.5)
   - 랜덤 포레스트 트리 수 (50~200)
   - 랜덤 시드 (1~100)
2. **결과 확인**: 각 단계별로 진행 상황과 결과를 확인할 수 있습니다

## 📊 출력 결과

### 성능 지표
- **MAE (평균 절대 오차)**: 예측값과 실제값의 평균 차이 (MW 단위)
- **R² (결정 계수)**: 모델의 설명력 (0~1, 높을수록 좋음)

### 시각화
- 예측값 vs 실제값 산점도
- 시간별 예측 결과 그래프
- 상세 예측 결과 테이블

### 데이터 관리
- 데이터 미리보기 및 편집
- 컬럼 정보 및 통계
- 결측값 확인
- 데이터 다운로드

## 🔧 원본 기능 유지

✅ 데이터 로딩 및 전처리  
✅ 특징 공학 (일교차, 열대야 제거)  
✅ 모델별 변수 분리  
✅ 랜덤 포레스트 학습  
✅ 성능 평가 (MAE, R²)  
✅ 인터랙티브 시각화 추가  
✅ 엑셀 파일 업로드 및 편집 기능 추가  

## 📁 파일 구조

```
project/
├── main.py              # Streamlit 앱 메인 파일
├── requirements.txt     # 필요한 라이브러리 목록
├── power_data.xlsx     # 전력 수요 데이터 파일 (기본)
└── README.md          # 사용법 설명서
```

## 🎨 추가된 기능

- **인터랙티브 웹 인터페이스**: Streamlit을 통한 사용자 친화적 UI
- **실시간 파라미터 조정**: 사이드바에서 모델 설정 변경
- **고급 시각화**: Plotly를 통한 인터랙티브 차트
- **진행 상황 표시**: 각 단계별 진행 상황과 로딩 애니메이션
- **성능 평가 메시지**: 모델 성능에 따른 자동 피드백
- **데이터 업로드**: 엑셀 파일 직접 업로드 기능
- **데이터 편집**: UI에서 직접 데이터 수정 가능
- **데이터 검증**: 필수 컬럼 확인 및 오류 처리
- **데이터 다운로드**: 편집된 데이터를 CSV로 다운로드

## 📋 필수 데이터 형식

업로드하는 엑셀 파일은 다음 컬럼을 포함해야 합니다:

| 컬럼명 | 데이터 타입 | 설명 |
|--------|-------------|------|
| 날짜 | datetime | 날짜 정보 |
| 최고기온 | numeric | 최고 기온 |
| 평균기온 | numeric | 평균 기온 |
| 최저기온 | numeric | 최저 기온 |
| 최대수요 | numeric | 최대 전력 수요 (MW) |
| 최저수요 | numeric | 최저 전력 수요 (MW) |
| 요일 | text | 요일 정보 |
| 평일 | text | 평일/주말 구분 | 
